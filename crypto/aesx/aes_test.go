package aesx

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestDecryptECB(t *testing.T) {
	key := []byte("soutuchaappsapi0")
	data := []byte("6328D6E1EF64C4F836D6AF447C0E7ED4C92751F6659BC11F499DA1F0C84A1A08DBA38DDF12D656445595789202A2358DC7E1AFFC95AE6062EBEE71100233EB605B4B10372AE26F14A31BF89942190AD685F4424881369016B23D2B7B29CDDFD3E7F3ACF43B8C16A69584FC94D27102E3497CCC36BC77BDB9AC9D3000B06A59C6B06B82058846AE2A65DD3BB2294B23DD93DBBE00CE8F7E5D666261306F0ADDD2012429DFA1E15E2725FFFB34C6BD8B3F163CA52867FDA6CCADAD19BD6D352B11F8281FB69AE5734F0E832A89B68DB0FC8C4112D684CC93E36B3007592B0853C45C0A83E31CB44EF886A5D30941BB81BB7C275252242D9B5912400F177FB5BFB4738D4DAEF0F18CB69911AE017B02A8A5474A70BEDB7AE0E43A70E926FEF3D1A8A0863C886D434BB3F58F8DA490F90E0F27406D4B4204CDD81722381DCAC92786CF52C42AF29DA4245CDC50F5BC1DF13F1EBA16AAE44F0490A8E37712D61DA1A2977AD4B51E4C1DDF96BA1A0D33DB27FC197E91526221B28A9B4042E35D430A03C3286A03360EB76A6476B42C5DFB1F902C5503E1BC6768D14704E621A3B5E374B0D9AB487572F6AE58DC1D890E774BE3F1E39E2B2BC6AC4E096F35516B2434DCA6315868E260C2263FA8E6117538055B32839CC5CCBA5B3113FDD3FDD5CC7CA776F67C29CCE7EC8CC9D334EBDC7E23F88C594BDFA2E57CA5265B50730C39C50254458BD5ACA64A40B82E112E5A8276894B698673FAD433BEB845BD32109753ADEDFB2405A7CBF9F8B7FF5CECB1B65536D7EEB4265B221680E0C04E9C9C712B20")

	res := Decrypt(data, key, Hex)
	expected := `{"login_token":"eee1da682f38794587e6b487bb25cf6e","token_key":"TEST","intranet_token":"Fp4LKO9MotaD92YVOw4Xfg3Obfy4mr7p5p19ZYwGgdTwLmSJdwdwC4dWg4miNTXksbZ8FJmdLkwEkYTGln/XZrntnYvBeU99TDTXgt0RqxeQD3kU90B0/A5H8czZOPUrDzTDOsKC0KbC4lWb0thxSE2fCH2PoRZGBQg22Ng5nlvoMUICpe44IdgaBCOhtRu+eX53i9Yt8BDoUiwjzac0XdusyjEy3am4WXlnol1GgUyLjPOeoSfmGZl7l510rX1vxy5y8mujfuN0woSQ1sB34WtVlbm83eRxCQiWUWp9jbvdPL88ZgaYa3xjnLX1uMysB2TZMh5kzu8aX0iECeDocw==","image_url":["https://img.ladynancy.com/public/5fc/74a/0a8/thumb_80408_344x420_0_0_auto_60.jpg"],"sites":["taobao","1688","vvic"]}`
	assert.Equal(t, expected, string(res))
}

func TestEncrypt(t *testing.T) {
	key := []byte("soutuchaappsapi0")
	data := []byte(`{"login_token":"eee1da682f38794587e6b487bb25cf6e","token_key":"TEST","intranet_token":"Fp4LKO9MotaD92YVOw4Xfg3Obfy4mr7p5p19ZYwGgdTwLmSJdwdwC4dWg4miNTXksbZ8FJmdLkwEkYTGln/XZrntnYvBeU99TDTXgt0RqxeQD3kU90B0/A5H8czZOPUrDzTDOsKC0KbC4lWb0thxSE2fCH2PoRZGBQg22Ng5nlvoMUICpe44IdgaBCOhtRu+eX53i9Yt8BDoUiwjzac0XdusyjEy3am4WXlnol1GgUyLjPOeoSfmGZl7l510rX1vxy5y8mujfuN0woSQ1sB34WtVlbm83eRxCQiWUWp9jbvdPL88ZgaYa3xjnLX1uMysB2TZMh5kzu8aX0iECeDocw==","image_url":["https://cbu01.alicdn.com/img/ibank/2020/899/573/22110375998_559587835.jpg"],"sites":["vvic", "1688", "taobao"],"is_origin":false}`)
	res := Encrypt(data, key, Hex)
	expected := "6328d6e1ef64c4f836d6af447c0e7ed4c92751f6659bc11f499da1f0c84a1a08dba38ddf12d656445595789202a2358dc7e1affc95ae6062ebee71100233eb605b4b10372ae26f14a31bf89942190ad685f4424881369016b23d2b7b29cddfd3e7f3acf43b8c16a69584fc94d27102e3497ccc36bc77bdb9ac9d3000b06a59c6b06b82058846ae2a65dd3bb2294b23dd93dbbe00ce8f7e5d666261306f0addd2012429dfa1e15e2725fffb34c6bd8b3f163ca52867fda6ccadad19bd6d352b11f8281fb69ae5734f0e832a89b68db0fc8c4112d684cc93e36b3007592b0853c45c0a83e31cb44ef886a5d30941bb81bb7c275252242d9b5912400f177fb5bfb4738d4daef0f18cb69911ae017b02a8a5474a70bedb7ae0e43a70e926fef3d1a8a0863c886d434bb3f58f8da490f90e0f27406d4b4204cdd81722381dcac92786cf52c42af29da4245cdc50f5bc1df13f1eba16aae44f0490a8e37712d61da1a2977ad4b51e4c1ddf96ba1a0d33db27fc197e91526221b28a9b4042e35d430a03c3286a03360eb76a6476b42c5dfb1f902c5503e1bc6768d14704e621a3b5e374b0d9ab487572f6ae58dc1d890e774be3f1e39e2b2bc6ac4e096f35516b2434dca6315868e260c2263fa8e6117538055b32839cc5ccba5b3113fdd3fdd5cc7ca776f67c29cce7ec8cc9d334ebdc7e23f88c594bdfa2e57ca5265b50730c39c50254458bd5aca64a40b82e112e5a82768945d6c666c28ae8de59954a1296bd85d0d7eeb4265b221680e0c04e9c9c712b20"
	assert.Equal(t, expected, string(res))
}
